<div class="mt-6">
  <h2 class="text-3xl font-bold">
    Manage Password
  </h2>
  <p class="mt-3 text-gray-600">
    To change your password, please enter your current password and the new password you would like to set.
  </p>
  <form [formGroup]="form" (ngSubmit)="submit()" class="w-full max-w-120 space-y-5">
    <div class="mt-6">
      <label class="block text-[12px] text-neutral-300 mb-2.5">Old password</label>
      <div class="relative">
        <input
          [type]="showOldPassword ? 'text' : 'password'"
          formControlName="oldPassword"
          class="w-full h-9.5 rounded-[10px] border border-neutral-200 bg-white px-4 pr-12 shadow-sm
           focus:outline-none focus:ring-4 focus:ring-lime-200"
          [class.border-neutral-200]="!isInvalid('oldPassword')"
          [class.focus:ring-lime-200]="!isInvalid('oldPassword')"
          [class.border-red-400]="isInvalid('oldPassword')"
          [class.focus:ring-red-200]="isInvalid('oldPassword')"
        />

        <button
          type="button"
          (click)="toggleOldPassword()"
          class="absolute right-3 top-3/4 -translate-y-3/4 text-neutral-400 hover:text-black cursor-pointer"
          [attr.aria-label]="showOldPassword ? 'Hide password' : 'Show password'"
        >
          @if (showOldPassword) {
            <ng-icon name = "bootstrapEye" size="20" > </ng-icon>
          } @else {
            <ng-icon name = "bootstrapEyeSlash" size="20"> </ng-icon>
          }
        </button>
      </div>
      @if (isInvalid('oldPassword') && f.password.hasError('required')) {
        <p class="mt-1 text-xs text-red-500">
          Required
        </p>
      }
    </div>
    <div class="mt-6">
      <label class="block text-[12px] text-neutral-300 mb-2.5">Password</label>
      <div class="relative">
        <input
          [type]="showPassword ? 'text' : 'password'"
          formControlName="password"
          class="w-full h-9.5 rounded-[10px] border border-neutral-200 bg-white px-4 pr-12 shadow-sm
           focus:outline-none focus:ring-4 focus:ring-lime-200"
          [class.border-neutral-200]="!isInvalid('password')"
          [class.focus:ring-lime-200]="!isInvalid('password')"
          [class.border-red-400]="isInvalid('password')"
          [class.focus:ring-red-200]="isInvalid('password')"
        />

        <button
          type="button"
          (click)="togglePassword()"
          class="absolute right-3 top-3/4 -translate-y-3/4 text-neutral-400 hover:text-black cursor-pointer"
          [attr.aria-label]="showPassword ? 'Hide password' : 'Show password'"
        >
          @if (showPassword) {
            <ng-icon name = "bootstrapEye" size="20" > </ng-icon>
          } @else {
            <ng-icon name = "bootstrapEyeSlash" size="20"> </ng-icon>
          }
        </button>
      </div>
      @if (isInvalid('password') && f.password.hasError('required')) {
        <p class="mt-1 text-xs text-red-500">
          Required
        </p>
      }
      @if (isInvalid('password') && f.password.hasError('minlength')) {
        <p class="mt-1 text-xs text-red-500">
          Min 6 chars
        </p>
      }
    </div>
    <div class="mt-6">
      <label class="block text-[12px] text-neutral-300 mb-2.5">Confirm password</label>
      <div class="relative">
        <input
          [type]="showConfirmPassword ? 'text' : 'password'"
          formControlName="confirmPassword"
          class="w-full h-9.5 rounded-[10px] border border-neutral-200 bg-white px-4 pr-12 shadow-sm
           focus:outline-none focus:ring-4 focus:ring-lime-200"
          [class.border-neutral-200]="!(isInvalid('confirmPassword') || mismatchActive)"
          [class.focus:ring-lime-200]="!(isInvalid('confirmPassword') || mismatchActive)"
          [class.border-red-400]="isInvalid('confirmPassword') || mismatchActive"
          [class.focus:ring-red-200]="isInvalid('confirmPassword') || mismatchActive"
        />

        <button
          type="button"
          (click)="toggleConfirmPassword()"
          class="absolute right-3 top-3/4 -translate-y-3/4 text-neutral-400 hover:text-black cursor-pointer"
          [attr.aria-label]="showConfirmPassword ? 'Hide password' : 'Show password'"
        >
          @if (showConfirmPassword) {
            <ng-icon name = "bootstrapEye" size="20" > </ng-icon>
          } @else {
            <ng-icon name = "bootstrapEyeSlash" size="20"> </ng-icon>
          }
        </button>
      </div>
      @if (f.confirmPassword.touched && f.confirmPassword.hasError('required')) {
        <p class="mt-1 text-xs text-red-500">
          Required
        </p>
      }
      @if (passwordMismatch) {
        <p class="mt-1 text-xs text-red-500">
          Passwords do not match
        </p>
      }
    </div>
    <button type="submit" class="mt-8 mx-auto block h-10.5 w-47.5 rounded-[10px] bg-[#C5E55D] text-black font-semibold shadow
                 hover:bg-lime-200 active:scale-[0.99] cursor-pointer">
      Confirm
    </button>
    @if (submitted) {
      <div class="mt-3 rounded-md border border-lime-200 bg-lime-50 p-3 text-sm text-neutral-700">
        Password successfully changed.
      </div>
    }
  </form>
</div>
